<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Tai Tong's Blog - JobChoice and Winning best in Data Analytics in MHacks</title>
  <link rel="shortcut icon" href="/assets/images/favicon.ico">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="alternate" type="application/rss+xml" title="My Blog" href="/rss.xml">
  <link rel="stylesheet" href="/assets/css/highlight.css">
</head>
<body>

  <nav class="main-nav">
    
        <a href='/'> <span class="arrow">←</span> Home </a>
    

    
        
            <a href='/about'>About </a>
        
    
    
     
        
            <a href='/notes'>Notes </a>
        
    
</nav>

  

  <section id="wrapper" class="">
    <article class="post">
    <header>
        <h1>JobChoice and Winning best in Data Analytics in MHacks</h1>
        <h2 class="headline">September 22, 2015</h2>
    </header>
    <section id="post-body">
        <h1 id="jobchoice">JobChoice</h1>

<h5 id="the-project-that-i-did-at-this-years-mhack6">The project that I did at this year’s MHack6</h5>

<p>This year at Michigan University’s 6th hackathon, MHack6, my partner (Ryan C Davis) and I set out to make a web application that made it simple for users to find which location
from your different job offers will best fit your choice of savings, comfort, and safety.</p>

<p><img src="http://mhacks.org/images/mhacks_logo.svg" alt="MHACKS Logo" /></p>

<p>The web application that we designed is composed of several different pieces of technology, lets list the stack now</p>
<ul>
  <li>Node JS</li>
  <li>Express</li>
  <li>Jade</li>
  <li>IBM Watson Trade Off analytics</li>
</ul>

<p>So how does all of these things work together? Lets dive in with this section by section explanation</p>

<h5 id="what-is-ibm-watson-trade-off-analytics">What is IBM Watson Trade Off Analytics?</h5>
<p>I am pretty much certain that you’ve heard about IBM’s Watson super computer, well if you didn’t know, it is a super computer that had the capability to understand and respond to a variety of different questions.
It was able to understand questions from Jeopardy and beat the top 3 champions back in 2011. But now in 2015 IBM has opened up Watson’s intelligent analytics platform for use by everyone through simple API calls in IBM Bluemix.</p>

<p>At the heart of JobChoice, is the analytics platform provided by Watson, our data is feed into Watson’s tradeoff analytics and from then on Watson replies with a JSON document containing its findings. The document is then further processed by the UI to utilize its answers for the graph JS widget provided by IBM.</p>

<p>IBM tradeoff analytics only require a JSON recipe to brew your solution. The JSON that you send to Watson will include the following:</p>

<ul>
  <li>Values to be returned with its format, key, how you want to optimize it (max/min), and a few presentation parameters</li>
  <li>Options, which are the input data that you will be sending over to Watson to be analyzed. These options should have the same parameters and should have all fields filled or Watson will be automatically discard the options with missing parameters</li>
</ul>

<p>That’s it, these two are the primary necessary components you need to get Watson to understand your problem and to have it respond to you with a solution.</p>

<p>The comparison takes data from a source that we scrap and uses an web api called import.io to handle the scraping of data and sending it back to us in JSON format.</p>

<h5 id="the-setup">The setup</h5>

<p>And to actually install Tradeoff analytics in your Node.JS application which are pretty standard for all the Node Packages, here are the steps to do so</p>

<ol>
  <li>Install Watson-Tradeoff analytics through npm by including this line in your package.json “watson-developer-cloud”: “~0.9.3”,</li>
  <li>Run NPM install to download the dependencies</li>
  <li>Create a folder called config and create two files within it, bluemix.js and express.js</li>
</ol>

<h5 id="bluemixjs">Bluemix.js</h5>

<p>Bluemix.js is the initial starting point of where IBM Bluemix service will start, and this code was copied directly from the <a href="https://github.com/watson-developer-cloud/tradeoff-analytics-nodejs">Bluemix</a> example however we changed it to reference from our credentials.json file:</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="s1">'use strict'</span><span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">getServiceCreds</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VCAP_SERVICES</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">services</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VCAP_SERVICES</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">service_name</span> <span class="k">in</span> <span class="nx">services</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">service_name</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">service</span> <span class="o">=</span> <span class="nx">services</span><span class="p">[</span><span class="nx">service_name</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
      <span class="k">return</span> <span class="p">{</span>
          <span class="na">url</span><span class="p">:</span> <span class="nx">service</span><span class="p">.</span><span class="nx">credentials</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span>
          <span class="na">username</span><span class="p">:</span> <span class="nx">service</span><span class="p">.</span><span class="nx">credentials</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span>
          <span class="na">password</span><span class="p">:</span> <span class="nx">service</span><span class="p">.</span><span class="nx">credentials</span><span class="p">.</span><span class="nx">password</span>
        <span class="p">};</span>
      <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">return</span> <span class="p">{};</span>
<span class="p">};</span>
</code></pre>
</div>
<h5 id="expressjs">Express.js</h5>

<p>Within the express.js it contains the an express application to which will be the main where the templating engine will reside. This design was a flaw from how we structured our application from the beginning of the hackathon, a better design would have been to merge this express.js with the app.js in the root directory. However we still have this as crucial part of the web app as it connects the Jade templating engine with the frontend of the application.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="s1">'use strict'</span><span class="p">;</span>
<span class="c1">// Module dependencies</span>
<span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">),</span>
<span class="nx">errorhandler</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'errorhandler'</span><span class="p">),</span>
<span class="nx">bodyParser</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'body-parser'</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">app</span><span class="p">)</span> <span class="p">{</span>

  <span class="c1">// Configure Express</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span> <span class="na">extended</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}));</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>

  <span class="c1">// Setup static public directory</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kr">static</span><span class="p">(</span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">'/../public'</span><span class="p">));</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'view engine'</span><span class="p">,</span> <span class="s1">'jade'</span><span class="p">);</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">'views'</span><span class="p">,</span> <span class="nx">__dirname</span> <span class="o">+</span> <span class="s1">'/../views'</span><span class="p">);</span>

  <span class="c1">// Add error handling in dev</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">VCAP_SERVICES</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">errorhandler</span><span class="p">());</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre>
</div>

<h5 id="the-problem-model">The problem model</h5>

<p>I won’t explain too much about how the data is scrapped but only on how to create the problem and then feed the problem model and give it to Bluemix as a solution to solving it.</p>

<p>As our problem was to compare the different living indexes across different cities, we have a fixed number of indexes that we are comparing. With the different indexes we want certain ones to be maximized(air quality, living standards) and others to be minimized(transportation costs, crime). These will be all information included in the problem model.</p>

<h5 id="lets-create-our-problem-model">Let’s create our problem model</h5>

<p>The problem model is a JSON array with all your parameters, and each parameters being filled with its corresponding values. A problem model JSON is composed of a columns JSON array proceeding that are the options JSON array. The columns JSON array will contain the variables that each option possesses to be compared across each other. While the options are going to be the dataset which will contain the data to be compared.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"subject"</span><span class="p">:</span><span class="s2">"ToMaximizeAandC"</span><span class="p">,</span>
<span class="s2">"columns"</span><span class="p">:[{}],</span>
<span class="s2">"options"</span><span class="p">:[{}]}</span>
</code></pre>
</div>
<p>A simple problem model could be where there are three variables that are being analyzed (variable A, B, and C). Our main objective for this problem is trying to maximize variables A and C). To formulate this problem for TradeOff analytics we would create a our columns JSON array like so to reflect our objectives</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="s2">"columns"</span><span class="err">:</span> <span class="p">[{</span>
<span class="s2">"key"</span><span class="p">:</span><span class="s2">"variableA"</span><span class="p">,</span>
<span class="s2">"type"</span><span class="p">:</span><span class="s2">"numeric"</span><span class="p">,</span>
<span class="s2">"goal"</span><span class="p">:</span><span class="s2">"max"</span><span class="p">,</span>
<span class="s2">"full_name"</span><span class="p">:</span><span class="s2">"Variable A"</span><span class="p">,</span>
<span class="s2">"is_objective"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
<span class="s2">"format"</span><span class="p">:</span><span class="s2">"####.##"</span>
<span class="p">},</span> <span class="p">{</span>
<span class="s2">"key"</span><span class="p">:</span><span class="s2">"variableB"</span><span class="p">,</span>
<span class="s2">"type"</span><span class="p">:</span><span class="s2">"numeric"</span><span class="p">,</span>
<span class="s2">"goal"</span><span class="p">:</span><span class="s2">"min"</span><span class="p">,</span>
<span class="s2">"full_name"</span><span class="p">:</span><span class="s2">"Variable B"</span><span class="p">,</span>
<span class="s2">"is_objective"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span>
<span class="s2">"format"</span><span class="p">:</span><span class="s2">"####.##"</span>
<span class="p">},</span> <span class="p">{</span>
<span class="s2">"key"</span><span class="p">:</span><span class="s2">"variableC"</span><span class="p">,</span>
<span class="s2">"type"</span><span class="p">:</span><span class="s2">"numeric"</span><span class="p">,</span>
<span class="s2">"goal"</span><span class="p">:</span><span class="s2">"max"</span><span class="p">,</span>
<span class="s2">"full_name"</span><span class="p">:</span><span class="s2">"Variable C"</span><span class="p">,</span>
<span class="s2">"is_objective"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
<span class="s2">"format"</span><span class="p">:</span><span class="s2">"####.##"</span>
<span class="p">}],</span>
</code></pre>
</div>
<p>From above we see that for the columns we have 3 different values, which are the corresponding variable A, B, and C. And their types are all numeric, with each having a different goal of whether to be maximized or minimized, and whether if it is part of our primary objectives or not. The key is what the options will have in its JSON document to refer it to the columns.</p>

<p>Within the options we will fill in 3 sample data</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="s2">"options"</span><span class="err">:</span><span class="p">[{</span>
<span class="s2">"key"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span>
<span class="s2">"name"</span><span class="p">:</span> <span class="s2">"first option"</span><span class="p">,</span>
<span class="s2">"values"</span><span class="p">:{</span>
<span class="s2">"variableA"</span> <span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="s2">"variableB"</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="s2">"variableC"</span> <span class="p">:</span> <span class="mi">99</span>
<span class="p">},{</span>
<span class="s2">"key"</span><span class="p">:</span><span class="s2">"2"</span><span class="p">,</span>
<span class="s2">"name"</span><span class="p">:</span> <span class="s2">"second option"</span><span class="p">,</span>
<span class="s2">"values"</span><span class="p">:{</span>
<span class="s2">"variableA"</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="s2">"variableB"</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
<span class="s2">"variableC"</span> <span class="p">:</span> <span class="mi">50</span>
<span class="p">},{</span>
<span class="s2">"key"</span><span class="p">:</span><span class="s2">"3"</span><span class="p">,</span>
<span class="s2">"name"</span><span class="p">:</span> <span class="s2">"third option"</span><span class="p">,</span>
<span class="s2">"values"</span><span class="p">:{</span>
<span class="s2">"variableA"</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="s2">"variableB"</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="s2">"variableC"</span> <span class="p">:</span> <span class="mi">3</span>
<span class="p">}]</span>
</code></pre>
</div>
<p>And the final structure should like this</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"subject"</span><span class="p">:</span><span class="s2">"ToMaximizeAandC"</span><span class="p">,</span>
<span class="s2">"columns"</span><span class="p">:</span> <span class="p">[{</span>
<span class="s2">"key"</span><span class="p">:</span><span class="s2">"variableA"</span><span class="p">,</span>
<span class="s2">"type"</span><span class="p">:</span><span class="s2">"numeric"</span><span class="p">,</span>
<span class="s2">"goal"</span><span class="p">:</span><span class="s2">"max"</span><span class="p">,</span>
<span class="s2">"full_name"</span><span class="p">:</span><span class="s2">"Variable A"</span><span class="p">,</span>
<span class="s2">"is_objective"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
<span class="s2">"format"</span><span class="p">:</span><span class="s2">"####.##"</span>
<span class="p">},</span> <span class="p">{</span>
<span class="s2">"key"</span><span class="p">:</span><span class="s2">"variableB"</span><span class="p">,</span>
<span class="s2">"type"</span><span class="p">:</span><span class="s2">"numeric"</span><span class="p">,</span>
<span class="s2">"goal"</span><span class="p">:</span><span class="s2">"min"</span><span class="p">,</span>
<span class="s2">"full_name"</span><span class="p">:</span><span class="s2">"Variable B"</span><span class="p">,</span>
<span class="s2">"is_objective"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span>
<span class="s2">"format"</span><span class="p">:</span><span class="s2">"####.##"</span>
<span class="p">},</span> <span class="p">{</span>
<span class="s2">"key"</span><span class="p">:</span><span class="s2">"variableC"</span><span class="p">,</span>
<span class="s2">"type"</span><span class="p">:</span><span class="s2">"numeric"</span><span class="p">,</span>
<span class="s2">"goal"</span><span class="p">:</span><span class="s2">"max"</span><span class="p">,</span>
<span class="s2">"full_name"</span><span class="p">:</span><span class="s2">"Variable C"</span><span class="p">,</span>
<span class="s2">"is_objective"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
<span class="s2">"format"</span><span class="p">:</span><span class="s2">"####.##"</span>
<span class="p">}],</span>
<span class="s2">"options"</span><span class="p">:[{</span>
<span class="s2">"key"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span>
<span class="s2">"name"</span><span class="p">:</span> <span class="s2">"first option"</span><span class="p">,</span>
<span class="s2">"values"</span><span class="p">:{</span>
<span class="s2">"variableA"</span> <span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="s2">"variableB"</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="s2">"variableC"</span> <span class="p">:</span> <span class="mi">99</span>
<span class="p">}},</span> <span class="p">{</span>
<span class="s2">"key"</span><span class="p">:</span><span class="s2">"2"</span><span class="p">,</span>
<span class="s2">"name"</span><span class="p">:</span> <span class="s2">"second option"</span><span class="p">,</span>
<span class="s2">"values"</span><span class="p">:{</span>
<span class="s2">"variableA"</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="s2">"variableB"</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
<span class="s2">"variableC"</span> <span class="p">:</span> <span class="mi">50</span>
<span class="p">}},</span> <span class="p">{</span>
<span class="s2">"key"</span><span class="p">:</span><span class="s2">"3"</span><span class="p">,</span>
<span class="s2">"name"</span><span class="p">:</span> <span class="s2">"third option"</span><span class="p">,</span>
<span class="s2">"values"</span><span class="p">:{</span>
<span class="s2">"variableA"</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="s2">"variableB"</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="s2">"variableC"</span> <span class="p">:</span> <span class="mi">3</span>
<span class="p">}}]</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Once we have our model set up we can initiate a call to bluemix with our data through a call to our tradeoffanalytics instance in our app.js which will return the final results in a JSON format.</p>

    </section>
</article>
<footer id="post-meta" class="clearfix">
    <a href="http://twitter.com/TaiRTong">
        <img class="avatar" src="/assets/images/avatar.png">
        <div>
            <span class="dark">Tai Tong</span>
            <span>Blog about everything from coding to anything I find interesting.</span>
        </div>
    </a>

    <section id="sharing">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=//2015/Winning-MHacks-With-JobChoice/ - JobChoice and Winning best in Data Analytics in MHacks by @TaiRTong"><span class="icon-twitter"> Tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>
    </section>
</footer>

<!-- Disqus comments -->


<!-- Archive post list -->





  </section>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/highlight.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54598212-3', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>



